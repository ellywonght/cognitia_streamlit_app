(content from canvas, trimmed for brevity)